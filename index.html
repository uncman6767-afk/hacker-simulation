<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hacker Code Simulator Ultimate</title>
<style>
body{background:black;color:#00ff00;font-family:monospace;margin:0}
#top{padding:10px;border-bottom:1px solid #0f0}
#files button{margin-right:5px}
#term{height:40vh;overflow-y:auto;padding:10px}
#editor{height:40vh;width:100%;background:#020202;color:#00ff00;border:none;outline:none;font-family:monospace}
.blue{color:cyan}
.red{color:red}
.yellow{color:yellow}
.gray{color:#888}
</style>
</head>
<body>

<div id="top">
<b>HACKER CODE OS v5.0</b> |
<button onclick="run()">RUN (CTRL+ENTER)</button>
<button onclick="save()">SAVE</button>
<button onclick="clearTerm()">CLEAR</button>
<div id="files"></div>
</div>

<div id="term"></div>
<textarea id="editor"></textarea>

<script>
const term=document.getElementById("term");
const editor=document.getElementById("editor");
const filesDiv=document.getElementById("files");

let level=1,money=0;
let currentFile="script1.hack";

const systems={
 bank:{sec:2,reward:500},
 police:{sec:4,reward:1200},
 corp:{sec:6,reward:2500}
};

const missions=[
 {text:"Hack the bank server",target:"bank"},
 {text:"Extract police data",target:"police"},
 {text:"Break corporate vault",target:"corp"}
];

let mission=0;

let files={
 "script1.hack":`// starter script
target = bank;

function hack() {
  bypassFirewall();
  decryptFiles();
}`
};

function print(t,c=""){let d=document.createElement("div");d.innerHTML=t;d.className=c;term.appendChild(d);term.scrollTop=99999}

function refreshFiles(){
 filesDiv.innerHTML="";
 for(let f in files){
  let b=document.createElement("button");
  b.textContent=f;
  b.onclick=()=>{currentFile=f;editor.value=files[f]};
  filesDiv.appendChild(b);
 }
}
refreshFiles();
editor.value=files[currentFile];

print("Mission: "+missions[mission].text,"yellow");
print("Write code and press CTRL+ENTER","gray");

editor.addEventListener("keydown",e=>{
 if(e.ctrlKey && e.key==="Enter") run();
});

function clearTerm(){term.innerHTML=""}

function save(){
 files[currentFile]=editor.value;
 localStorage.setItem("hack_files",JSON.stringify(files));
 print("Files saved.","blue");
}

function run(){
 files[currentFile]=editor.value;
 let code=editor.value.split("\n");
 let target=null;
 let hasHack=false,firewall=false,decrypt=false;

 for(let i=0;i<code.length;i++){
  let line=code[i].trim();

  if(line.startsWith("target")){
   let t=line.split("=")[1].replace(";","").trim();
   target=systems[t];
   if(!target) return error(i,"Unknown target");
  }
  if(line.startsWith("function hack")) hasHack=true;
  if(line.includes("bypassFirewall")) firewall=true;
  if(line.includes("decryptFiles")) decrypt=true;
 }

 if(!hasHack) return error(0,"Missing hack() function");
 if(!target) return error(0,"No target set");

 if(level<target.sec) return error(0,"Security level too high");

 if(firewall && decrypt){
  money+=target.reward;
  print("SUCCESS: Data extracted","yellow");
  print("Earned $"+target.reward);
  level++;
  mission++;
  if(mission<missions.length)
   print("New mission: "+missions[mission].text,"yellow");
  else
   print("ALL MISSIONS COMPLETE","blue");
 }else{
  error(0,"Incomplete script logic");
 }
}

function error(line,msg){
 print("ERROR line "+(line+1)+": "+msg,"red");
}

let saved=localStorage.getItem("hack_files");
if(saved){files=JSON.parse(saved);refreshFiles()}
</script>

</body>
</html>
